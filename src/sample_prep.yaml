id: https://w3id.org/nmdc/sample_prep
name: sample_prep
title: NMDC sample prep schema
description: Material and activity classes for describing sample preparation, in support of EMSL, Monet, MANA, etc.

license: https://creativecommons.org/publicdomain/zero/1.0/

see_also:
  - https://gitlab.pnnl.gov/MoNET/analytical-processes/-/blob/main/organicmatterextraction.toml

#notes:
#  - "circular nmdc import is for slot biosample_input with range: Biosample"

imports:
  - core
#  - nmdc

prefixes:
  CHEBI: http://purl.obolibrary.org/obo/CHEBI_ # in https://github.com/prefixcommons/biocontext/blob/master/registry/obo_context.jsonld
  CHMO: http://purl.obolibrary.org/obo/CHMO_ # in https://github.com/prefixcommons/biocontext/blob/master/registry/obo_context.jsonld
  OBI: http://purl.obolibrary.org/obo/OBI_ # in https://github.com/prefixcommons/biocontext/blob/master/registry/obo_context.jsonld

  linkml: https://w3id.org/linkml/
  nmdc: https://w3id.org/nmdc/

default_prefix: nmdc
default_range: string


enums:
  ContainerTypeEnum:
    title: Container type enumeration
    permissible_values:
      screw_top_conical:
        title: Screw top conical tube
        aliases:
          - falcon tube
  DeviceTypeEnum:
    title: Shaker type enumeration
    permissible_values:
      orbital_shaker:
        title: Orbital shaker
      thermomixer:
        title: Thermomixer
  SamplingMethodEnum:
    permissible_values:
      weighing:
        title: Weighing
  SolventEnum:
    title: Solvent enumeration
    permissible_values:
      deionized_water:
        title: Deionized water
        broad_mappings:
          - CHEBI:15377
      methanol:
        title: Methanol
        meaning: CHEBI:17790
      chloroform:
        title: Chloroform
        meaning: CHEBI:35255
slots:
  dissolving_activity_set:
    title: dissolving activity set
    multivalued: true
    range: DissolvingActivity
    inlined_as_list: true
  material_sample_set:
    title: material sample set
    multivalued: true
    range: MaterialSample
    inlined_as_list: true
  material_sampling_activity_set:
    title: material sampling activity set
    multivalued: true
    range: MaterialSamplingActivity
    inlined_as_list: true
  reaction_activity_set:
    multivalued: true
    range: ReactionActivity
    inlined_as_list: true
  dissolution_aided_by:
    title: dissolution aided by
    aliases:
      - shaker
    range: LabDevice
    inlined: true
  dissolution_reagent:
    title: dissolution reagent
    aliases:
      - solvent
    range: SolventEnum
  dissolution_volume:
    title: dissolution volume
    aliases:
      - volume
    range: QuantityValue
    inlined: true
  dissolved_in:
    title: dissolved in
    aliases:
      - container
    range: MaterialContainer
    inlined: true
  #  biosample_input:
  #    title: biosample input
  #    range: Biosample
  material_input:
    title: material input
    range: MaterialSample
  material_output:
    title: material output
    range: MaterialSample
  device_type:
    title: device type
    aliases:
      - shaker type
    range: DeviceTypeEnum
  activity_speed:
    title: activity speed
    aliases:
      - shake_speed
    range: QuantityValue
    inlined: true
  activity_temperature:
    todos:
      - constrain units
    range: QuantityValue
    inlined: true
  activity_time:
    title: activity time
    aliases:
      - shake_time
    range: QuantityValue
    inlined: true
  container_size:
    title: container size
    range: QuantityValue
    inlined: true
  container_type:
    title: container type
    range: ContainerTypeEnum
  amount_collected:
    title: amount collected
    range: QuantityValue
    inlined: true
  collected_into:
    title: collected into

  sampling_method:
    title: sampling method
    range: SamplingMethodEnum

  reaction_aided_by:
    title: reaction aided by
    aliases:
      - shaker
    range: LabDevice
    inlined: true
  reaction_temperature:
  reaction_time:


classes:
  DissolvingActivity:
    title: Dissolving activity
    aliases:
      - dissolution-activity
    slots:
      - dissolution_aided_by
      - dissolution_reagent
      - dissolution_volume
      - dissolved_in
      - material_input
      - material_output
    slot_usage:
      material_input:
        examples:
          - value: somextract:6
        range: MaterialSample
      material_output:
        examples:
          - value: somextract:7
        range: MaterialSample
    class_uri: CHMO:0002773
  LabDevice:
    title: Lab device
    slots:
      - device_type
      - activity_speed
      - activity_temperature
      - activity_time
  MaterialContainer:
    title: Material container
    slots:
      - container_size
      - container_type
  MaterialSample:
    title: Material sample
    aliases:
      - Material entity
    is_a: NamedThing
    slot_usage:
      id:
        required: true
        structured_pattern:
          syntax: "{id_nmdc_prefix}:matsm-{id_shoulder}-{id_blade}{id_version}{id_locus}"
          interpolated: true

  MaterialSamplingActivity:

    title: Material sampling activity
    aliases:
      - weighing-activity
    slots:
      - amount_collected
      - collected_into
      #      - biosample_input
      - material_output
      - sampling_method
    slot_usage:
      amount_collected:
        aliases:
          - weighing-activity.weight
      collected_into:
        aliases:
          - weighing-activity.contanier
        range: MaterialContainer
        inlined: true
      #      biosample_input:
      #        examples:
      #          - value: soil:1
      #        aliases:
      #          - weighing-activity.source_material
      material_output:
        examples:
          - value: somextract:6
        aliases:
          - weighing-activity.id
        range: MaterialSample
      sampling_method:
    class_uri: OBI:0000744

  ReactionActivity:
    title: Reaction activity
    aliases:
      - reaction-activity
    slots:
      - material_input
      - material_output
      - reaction_aided_by
      - reaction_temperature
      - reaction_time
    slot_usage:
      material_input:
        range: MaterialSample
      material_output:
        range: MaterialSample
      reaction_time:
        todos:
          - constrain units
          - align with activity_time
        range: QuantityValue
        inlined: true
