id: https://microbiomedata/schema/core
name: NMDC-Core
title: NMDC Schema Core Types
description: >-
  Schema for National Microbiome Data Collaborative (NMDC), Core Types
license: https://creativecommons.org/publicdomain/zero/1.0/

notes:
  - "removed MS: http://purl.obolibrary.org/obo/MS_ prefix assignment"
  - "removed PR: http://identifiers.org/pr/ prefix assignment"

prefixes:
  KEGG.COMPOUND: http://identifiers.org/kegg.compound/
  UniProtKB: https://identifiers.org/uniprot/
  biolink: https://w3id.org/biolink/vocab/
  dcterms: http://purl.org/dc/terms/
  gtpo: https://unknown.to.linter.org/
  igsnvoc: https://igsn.org/voc/v1/
  linkml: https://w3id.org/linkml/
  mixs: https://w3id.org/mixs/
  nmdc: https://w3id.org/nmdc/
  qud: http://qudt.org/1.1/schema/qudt#
  rdf: http://www.w3.org/1999/02/22-rdf-syntax-ns#
  schema: http://schema.org/
  sio: http://semanticscience.org/resource/SIO_
  skos: http://www.w3.org/2004/02/skos/core#
  wgs84: http://www.w3.org/2003/01/geo/wgs84_pos#

default_prefix: nmdc
default_range: string

default_curi_maps:
  - obo_context
  - idot_context


imports:
  - basic_slots
  - linkml:types
  - prov

subsets:
  environment: { }
  investigation: { }
  nucleic acid sequence source: { }
  sequencing: { }
  soil: { }

types:

  bytes:
    description: >-
      An integer value that corresponds to a size in bytes
    base: int
    uri: xsd:long
    see_also:
      - UO:0000233
  
  decimal degree:
    description: >-
      A decimal degree expresses latitude or longitude as decimal fractions.
    uri: xsd:decimal
    base: float
    see_also:
      - https://en.wikipedia.org/wiki/Decimal_degrees

  language code:
    description: >-
      A language code conforming to ISO_639-1
    see_also:
      - https://en.wikipedia.org/wiki/ISO_639-1
    base: str
    uri: xsd:language

  unit:
    base: str
    uri: xsd:string
    mappings:
      - qud:Unit
      - UO:0000000



classes:

  NamedThing:
    description: "a databased entity or concept/class"
    abstract: true
    slots:
      - id
      - name
      - description
      - alternative_identifiers
  #    slot_usage:
  #      id:
  #        structured_pattern:
  #          todos:
  #          syntax: "{id_nmdc_prefix}:{id_typecode_named_thing}-{id_shoulder}-{id_blade}{id_version}{id_locus}"
  #          interpolated: true
  #          partial_match: false


  MaterialEntity:
    abstract: true
    aliases:
      - Material
      - Physical entity
    is_a: NamedThing
    title: Material Entity
  #    slot_usage:
  #      id:
  #        pattern: '^nmdc:mate'
  #        structured_pattern:
  #          syntax: "{id_nmdc_prefix}:mate-{id_shoulder}-{id_blade}{id_version}{id_locus}"
  #          interpolated: true
  #          partial_match: false

  AnalyticalSample:
    is_a: MaterialEntity
    title: Analytical Sample
    slot_usage:
      id:
        #        pattern: '^nmdc:ansm'
        structured_pattern:
          syntax: "{id_nmdc_prefix}:ansm-{id_shoulder}-{id_blade}{id_version}{id_locus}"
          interpolated: true
          partial_match: false

  Site:
    abstract: true
    is_a: MaterialEntity
    title: Site
    comments:
      - BCO sample collection site ?
    slot_usage:
      id:
        #        pattern: '^nmdc:site'
        structured_pattern:
          syntax: "{id_nmdc_prefix}:site-{id_shoulder}-{id_blade}{id_version}{id_locus}"
          interpolated: true
          partial_match: false

  PlannedProcess:
    abstract: true
    class_uri: OBI:0000011
    is_a: NamedThing
    title: Planned Process
    slots:
      - has_inputs
      - has_outputs
      - participating_agent

  OntologyClass:
    is_a: NamedThing
    notes:
      - The identifiers for terms from external ontologies can't have their ids constrained to the nmdc namespace
  #    slot_usage:
  #      id:
  #        pattern: '^nmdc:ontc'
  #        structured_pattern:
  #          syntax: "{id_nmdc_prefix}:ontc-{id_shoulder}-{id_blade}{id_version}{id_locus}"
  #          interpolated: true
  #          partial_match: false

  EnvironmentalMaterialTerm:
    is_a: OntologyClass

  AttributeValue:
    description: >-
      The value for any value of a attribute for a sample. This object can hold both the un-normalized atomic
      value and the structured value
    slots:
      - has_raw_value
      - was_generated_by
    slot_usage:
      type:
        description: >-
          An optional string that specified the type of object.
        required: false

  QuantityValue:
    is_a: AttributeValue
    description: >-
      A simple quantity, e.g. 2cm
    slots:
      - has_unit
      - has_numeric_value
      - has_minimum_numeric_value
      - has_maximum_numeric_value
    slot_usage:
      has_raw_value:
        description: >-
          Unnormalized atomic string representation, should in syntax {number} {unit}
      has_unit:
        description: >-
          The unit of the quantity
      has_numeric_value:
        description: >-
          The number part of the quantity
        range:
          double
    mappings:
      - schema:QuantityValue

  ImageValue:
    is_a: AttributeValue
    description: >-
      An attribute value representing an image.
    slots:
      - url
      - description
      - display_order
  
  PersonValue:
    is_a: AttributeValue
    description: >-
      An attribute value representing a person
    slots:
      - orcid
      - profile_image_url
      - email
      - name
      - websites
    todos:
      - add additional fields e.g for institution
      - deprecate "has_raw_value" in favor of "name"
    slot_usage:
      orcid:
        annotations:
          display_hint:
            tag: display_hint
            value: Open Researcher and Contributor ID for this person. See https://orcid.org
      email:
        annotations:
          display_hint:
            tag: display_hint
            value: Email address for this person.
      has_raw_value:
        description: >-
          The full name of the Investigator in format FIRST LAST.
        notes: >-
          May eventually be deprecated in favor of "name".
      name:
        description: >-
          The full name of the Investigator.
          It should follow the format FIRST [MIDDLE NAME| MIDDLE INITIAL] LAST, where MIDDLE NAME| MIDDLE INITIAL is optional.
        annotations:
          display_hint:
            tag: display_hint
            value: First name, middle initial, and last name of this person.

  Person:
    is_a: NamedThing
    description: >-
      represents a person, such as a researcher
    notes:
      - "not yet in use"
    slot_usage:
      id:
        description: >-
          Should be an ORCID. Specify in CURIE format. E.g ORCID:0000-1111-...
  
  MagBin:
    slots:
      - type
    attributes:
      bin_name:
        range: string
      number_of_contig:
        range: integer
      completeness:
        range: float
      contamination:
        range: float
      gene_count:
        range: integer
      bin_quality:
        range: string
      num_16s:
        range: integer
      num_5s:
        range: integer
      num_23s:
        range: integer
      num_t_rna:
        range: integer
      gtdbtk_domain:
        required: false
        range: string
      gtdbtk_phylum:
        required: false
        range: string
      gtdbtk_class:
        required: false
        range: string
      gtdbtk_order:
        required: false
        range: string
      gtdbtk_family:
        required: false
        range: string
      gtdbtk_genus:
        required: false
        range: string
      gtdbtk_species:
        required: false
        range: string

  Instrument:
    is_a: NamedThing
    aliases:
      - device
    description: >-
      A material entity that is designed to perform a function in a scientific investigation, but is not a reagent[OBI].
    exact_mappings:
      - OBI:0000485
    slot_usage:
      id:
        #        pattern: '^nmdc:inst'
        structured_pattern:
          syntax: "{id_nmdc_prefix}:inst-{id_shoulder}-{id_blade}{id_version}{id_locus}"
          interpolated: true
          partial_match: false

  MetaboliteQuantification:
    description: >-
      This is used to link a metabolomics analysis workflow to a specific metabolite
    slots:
      - alternative_identifiers
    slot_usage:
      metabolite_quantified:
        description: >-
          the specific metabolite identifier
        range: ChemicalEntity
      highest_similarity_score:
        description: >-
          TODO: Yuri to fill in
        range: float

  PeptideQuantification:
    description: >-
      This is used to link a metaproteomics analysis workflow to a specific peptide sequence and related information
    slot_usage:
      peptide_sequence:
        range: string
      best_protein:
        description: >-
          the specific protein identifier most correctly associated with the peptide sequence
        range: GeneProduct
      all_proteins:
        description: >-
          the list of protein identifiers that are associated with the peptide sequence
        range: GeneProduct
        multivalued: true
      min_q_value:
        description: >-
          smallest Q-Value associated with the peptide sequence as provided by MSGFPlus tool
        range: float
        see_also:
          - OBI:0001442
      peptide_spectral_count:
        description: >-
          sum of filter passing MS2 spectra associated with the peptide sequence within a given LC-MS/MS data file
        range: integer
      peptide_sum_masic_abundance:
        description: >-
          combined MS1 extracted ion chromatograms derived from MS2 spectra associated with the peptide sequence from a given LC-MS/MS data file using the MASIC tool
        range: integer
  
  ProteinQuantification:
    description: >-
      This is used to link a metaproteomics analysis workflow to a specific protein
    slot_usage:
      best_protein:
        description: >-
          the specific protein identifier most correctly grouped to its associated peptide sequences
        range: GeneProduct
      all_proteins:
        description: >-
          the grouped list of protein identifiers associated with the peptide sequences that were grouped to a best protein
        range: GeneProduct
        multivalued: true
      peptide_sequence_count:
        description: >-
          count of peptide sequences grouped to the best_protein
        range: integer
      protein_spectral_count:
        description: >-
          sum of filter passing MS2 spectra associated with the best protein within a given LC-MS/MS data file
        range: integer
      protein_sum_masic_abundance:
        description: >-
          combined MS1 extracted ion chromatograms derived from MS2 spectra associated with the best protein from a given LC-MS/MS data file using the MASIC tool
        range: integer

  ChemicalEntity:
    aliases:
      - metabolite
      - chemical substance
      - chemical compound
      - chemical
    is_a: OntologyClass
    description: >-
      An atom or molecule that can be represented with a chemical formula. Include lipids, glycans, natural products, drugs.
      There may be different terms for distinct acid-base forms, protonation states
    comments:
      - As with the parent OntologyClass, we will not assign an nmdc id pattern or typecode to this class.
    slot_usage:
      #      id:
      #        pattern: '^nmdc:cheme'
      #        structured_pattern:
      #          syntax: "{id_nmdc_prefix}:cheme-{id_shoulder}-{id_blade}{id_version}{id_locus}"
      #          interpolated: true
      #          partial_match: false
      inchi:
        key: false
        multivalued: false
        range: string
      inchi_key:
        key: false
        multivalued: false
        range: string
      smiles:
        description: >-
          A string encoding of a molecular graph, no chiral or isotopic information. There are usually a large number of valid SMILES which represent a given structure. For example, CCO, OCC and C(O)C all specify the structure of ethanol.
        multivalued: true
        range: string
      chemical_formula:
        description: >-
          A generic grouping for miolecular formulae and empirican formulae
        multivalued: false
        key: false
        range: string
    see_also:
      - https://bioconductor.org/packages/devel/data/annotation/vignettes/metaboliteIDmapping/inst/doc/metaboliteIDmapping.html
    id_prefixes:
      - CAS
      - CHEBI
      - CHEMBL.COMPOUND
      - DRUGBANK
      - HMDB
      - KEGG.COMPOUND
      - MESH
      - PUBCHEM.COMPOUND
    exact_mappings:
      - biolink:ChemicalSubstance

  GeneProduct:
    is_a: NamedThing
    description: >-
      A molecule encoded by a gene that has an evolved function
    notes:
      - we may include a more general gene product class in future to allow for ncRNA annotation
    id_prefixes:
      - PR
      - UniProtKB
      - gtpo
    exact_mappings:
      - biolink:GeneProduct

  TextValue:
    is_a: AttributeValue
    description: >-
      A basic string value
    slots:
      - language

  UrlValue:
    is_a: AttributeValue
    description: >-
      A value that is a string that conforms to URL syntax

  TimestampValue:
    is_a: AttributeValue
    description: >-
      A value that is a timestamp. The range should be ISO-8601
    notes:
      - "removed the following slots: year, month, day"

  IntegerValue:
    is_a: AttributeValue
    description: >-
      A value that is an integer
    slots:
      - has_numeric_value

  BooleanValue:
    is_a: AttributeValue
    description: >-
      A value that is a boolean
    slots:
      - has_boolean_value

  ControlledTermValue:
    is_a: AttributeValue
    description: >-
      A controlled term or class from an ontology
    slots:
      - term
    todos:
      - add fields for ontology, branch

  ControlledIdentifiedTermValue:
    description: A controlled term or class from an ontology, requiring the presence of term with an id
    notes:
      - To be used for slots like env_broad_scale
    is_a: ControlledTermValue
    slot_usage:
      term:
        required: true

  GeolocationValue:
    is_a: AttributeValue
    description: >-
      A normalized value for a location on the earth's surface
    slots:
      - latitude
      - longitude
    notes:
      - "what did 'to_str: {latitude} {longitude}' mean?"
    slot_usage:
      has_raw_value:
        description: >-
          The raw value for a  geolocation should follow {lat} {long}
    mappings:
      - schema:GeoCoordinates

slots:

  has_inputs:
    domain: PlannedProcess
    multivalued: true
    range: NamedThing

  has_outputs:
    domain: PlannedProcess
    multivalued: true
    range: NamedThing

  participating_agent:
    domain: PlannedProcess
    range: Agent


  language:
    range: language code
    description: >-
      Should use ISO 639-1 code e.g. "en", "fr"

  attribute:
    aliases: [ 'field', 'property', 'template field', 'key', 'characteristic' ]
    abstract: true
    description: >-
      A attribute of a biosample. Examples: depth, habitat, material.
      For NMDC, attributes SHOULD be mapped to terms within a MIxS template

  has_raw_value:
    description: >-
      The value that was specified for an annotation in raw form, i.e. a string. E.g. "2 cm" or "2-4 cm"
    multivalued: false
    required: false
    domain: AttributeValue
    range: string

  has_unit:
    description: >-
      Links a QuantityValue to a unit
    aliases:
      - scale
    range: unit
    mappings:
      - qud:unit
      - schema:unitCode

  has_numeric_value:
    description: >-
      Links a quantity value to a number
    multivalued: false
    range: float
    mappings:
      - qud:quantityValue
      - schema:value
  
  has_minimum_numeric_value:
    is_a: has_numeric_value
    description: >-
      The minimum value part, expressed as number, of the quantity value when the value covers a range.

  has_maximum_numeric_value:
    is_a: has_numeric_value
    description: >-
      The maximum value part, expressed as number, of the quantity value when the value covers a range.
  
  has_boolean_value:
    description: >-
      Links a quantity value to a boolean
    range: boolean
    multivalued: false
  
  latitude:
    domain: GeolocationValue
    range: decimal degree
    description: >-
      latitude
    slot_uri: wgs84:lat
    mappings:
      - schema:latitude

  longitude:
    domain: GeolocationValue
    range: decimal degree
    description: >-
      longitude
    slot_uri: wgs84:long
    mappings:
      - schema:longitude

  term:
    domain: ControlledTermValue
    range: OntologyClass
    description: >-
      pointer to an ontology class
    inlined: true
    notes:
      - "removed 'slot_uri: rdf:type'"

  orcid:
    description: >-
      The ORCID of a person.
    domain: PersonValue
    range: string

  email:
    description: >-
      An email address for an entity such as a person.
      This should be the primarly email address used.
    range: string
    slot_uri: schema:email

  alternate_emails:
    description: >-
      One or more other email addresses for an entity.
    range: string

  profile_image_url:
    description: >-
      A url that points to an image of a person.
    domain: PersonValue
    range: string
  
  has_input:
    aliases: [ 'input' ]
    domain: NamedThing
    range: NamedThing
    multivalued: true
    description: >-
      An input to a process.

  has_output:
    aliases: [ 'output' ]
    domain: NamedThing
    range: NamedThing
    multivalued: true
    description: >-
      An output biosample to a processing step

  part_of:
    aliases: [ 'is part of' ]
    range: NamedThing
    domain: NamedThing
    multivalued: true
    slot_uri: dcterms:isPartOf
    description: >-
      Links a resource to another resource that either logically or physically includes it.
  
  execution_resource:
    is_a: attribute
    description: >-
      Example: NERSC-Cori

  url:
    is_a: attribute
    range: string
    notes:
      - See issue 207 - this clashes with the mixs field
  
  display_order:
    is_a: attribute
    description: >-
      When rendering information, this attribute to specify the order in which the information should be rendered.

  git_url:
    is_a: attribute
    range: string
    description: >-
      Example: https://github.com/microbiomedata/mg_annotation/releases/tag/0.1

  file_size_bytes:
    is_a: attribute
    range: bytes
    description: >-
      Size of the file in bytes
  
  md5_checksum:
    is_a: attribute
    range: string
    description: >-
      MD5 checksum of file (pre-compressed)
  
  abstract:
    range: string
    description: >-
      The abstract of manuscript/grant associated with the entity; i.e., a summary of the resource.
    exact_mappings:
      - dcterms:abstract

  keywords:
    range: string
    multivalued: true
    description: >-
      A list of keywords that used to associate the entity.
      Keywords SHOULD come from controlled vocabularies, including MESH, ENVO.
    mappings:
      - dcterms:subject
  
  objective:
    range: string
    multivalued: false
    description: >-
      The scientific objectives associated with the entity.
      It SHOULD correspond to scientific norms for objectives field in a structured abstract.
    mappings:
      - sio:000337

  websites:
    range: string
    multivalued: true
    description: >-
      A list of websites that are associated with the entity.

  publications:
    range: string
    multivalued: true
    description: >-
      A list of publications that are associated with the entity.
      The publications SHOULD be given using an identifier, such as a DOI or Pubmed ID, if possible.

  all_proteins:
  best_protein:
  chemical_formula:
  inchi_key:
    notes:
      - "key set to false due to rare collisions: Pletnev I, Erin A, McNaught A, Blinov K, Tchekhovskoi D, Heller S (2012) InChIKey collision resistance: an experimental testing. J Cheminform. 4:12"
  inchi:
  min_q_value:
  peptide_sequence:
  peptide_sequence_count:
  peptide_spectral_count:
  peptide_sum_masic_abundance:
  protein_spectral_count:
  protein_sum_masic_abundance:
  smiles:
  metabolite_quantified:
  highest_similarity_score: